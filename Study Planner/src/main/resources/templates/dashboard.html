<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="fr">
<head th:replace="~{fragments/layout :: head('Dashboard')}"></head>
<body class="app-body">
<header th:replace="~{fragments/layout :: appNav('dashboard')}"></header>
<div class="app-shell">
    <h1 class="page-title">Tableau de bord</h1>
    <p class="page-subtitle">Vue d'ensemble TeamLife de vos révisions</p>

    <div class="app-grid mb-4">
        <div class="app-card">
            <p class="card-title">Matières suivies</p>
            <p class="metric" th:text="${subjectCount}">0</p>
        </div>
        <div class="app-card">
            <p class="card-title">Sessions planifiées</p>
            <p class="metric" th:text="${sessionCount}">0</p>
        </div>
        <div class="app-card">
            <p class="card-title">Score IA</p>
            <p class="metric" th:text="${aiReport.productivityScore}">0</p>
        </div>
    </div>

    <div class="app-card mb-4">
        <div class="d-flex justify-content-between align-items-center">
            <div>
                <p class="card-title mb-1">Temps quotidien (7 jours)</p>
                <small class="text-muted">Répartition des minutes d'étude</small>
            </div>
            <span class="tag">IA Insight</span>
        </div>
        <canvas id="dailyChart" class="mt-3"></canvas>
    </div>

    <div class="app-card">
        <p class="card-title">Conseils générés par l'IA</p>
        <ul class="mb-0">
            <li th:each="suggestion : ${aiReport.suggestions}" th:text="${suggestion}"></li>
        </ul>
    </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
<script th:inline="javascript">
    /*<![CDATA[*/
    const labels = /*[[${dailyStatsKeys}]]*/ [];
    const values = /*[[${dailyStatsValues}]]*/ [];
    new Chart(document.getElementById('dailyChart'), {
        type: 'bar',
        data: {
            labels: labels,
            datasets: [{
                label: 'Minutes',
                backgroundColor: 'rgba(108,99,255,0.7)',
                borderColor: 'rgba(108,99,255,1)',
                borderWidth: 1,
                data: values
            }]
        },
        options: {
            scales: {
                y: { beginAtZero: true }
            }
        }
    });
    /*]]>*/
</script>
</body>
</html>

